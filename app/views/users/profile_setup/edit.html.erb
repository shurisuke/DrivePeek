<div class="auth-page">
  <div class="auth-card">
    <% if params[:from] == "signup" %>
      <%# 新規登録から来た場合 %>
      <h2 class="auth-title">プロフィール設定</h2>
      <p class="auth-description">3つ選んで、すぐにプランを作ろう！</p>
    <% else %>
      <%# 設定画面から来た場合 %>
      <div class="auth-header">
        <%= link_to settings_path, class: "auth-back-link" do %>
          <i class="bi bi-chevron-left"></i>
        <% end %>
        <h2 class="auth-title">プロフィール</h2>
      </div>
    <% end %>

    <%= simple_form_for(@user, url: users_profile_setup_path(from: params[:from]), method: :patch, html: { class: "auth-form auth-form--profile" }) do |f| %>
      <% if @user.errors.any? %>
        <ul class="auth-errors">
          <% @user.errors.full_messages.uniq.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      <% end %>

      <%= render "devise/registrations/profile_fields", f: f %>

      <hr class="auth-separator">

      <% if params[:from] == "signup" %>
        <%= f.button :submit, "設定を完了してはじめる", class: "auth-submit" %>
      <% else %>
        <%= f.button :submit, "変更を保存", class: "auth-submit" %>
      <% end %>
    <% end %>

    <% if params[:from] == "signup" %>
      <div class="auth-skip">
        <%= link_to "スキップしてはじめる", new_plan_path, class: "auth-skip-link" %>
      </div>
    <% else %>
      <p class="settings-hint" style="margin-top: 1.5rem; margin-bottom: 0; text-align: center; line-height: 1.7;">
        スポットへのコメント時のみこの情報は公開されます。<br>
        プラン公開時にユーザー情報は公開されません。<br>
        おすすめ機能の改善にも活用されます。
      </p>
    <% end %>
  </div>
</div>
