<aside class="navibar"
       data-controller="ui--navibar ui--bottom-sheet"
       data-ui--bottom-sheet-min-value="8"
       data-ui--bottom-sheet-mid-value="45"
       data-ui--bottom-sheet-max-value="85"
       data-ui--bottom-sheet-state-value="mid">
  <%# モバイル用ドラッグハンドル %>
  <div class="navibar__handle" data-ui--bottom-sheet-target="handle">
    <div class="navibar__handle-bar"></div>
  </div>

  <div class="plan-tab-nav">
    <button class="tab-btn tab-community"
            data-tab="community"
            data-ui--navibar-target="button"
            data-action="click->ui--navibar#switch">
      みんなの旅
    </button>

    <button class="tab-btn active"
            data-tab="plan"
            data-ui--navibar-target="button"
            data-action="click->ui--navibar#switch">
      プラン
    </button>

    <button class="tab-btn tab-suggestion"
            data-tab="suggestion"
            data-ui--navibar-target="button"
            data-action="click->ui--navibar#switch">
      提案
    </button>
  </div>

  <div class="navibar__content" id="navibar_content">
    <%# ✅ スクロールコンテナ: OFF時350px / ON時430px %>
    <div class="navibar__content-scroll">
      <%# ブロック一覧（常時350px） %>
      <div class="navibar__blocks" id="navibar_blocks">
        <%= render "plans/navibar_tabs", plan: plan %>
      </div>
    </div>
  </div>

  <div id="navibar_footer">
    <%= render "plans/navibar_footer", plan: plan %>
  </div>

  <%# 提案タブ用フッター %>
  <div class="suggestion__composer"
       data-ui--navibar-target="footer"
       data-tab="suggestion">
    <%= render "suggestions/form", plan: plan %>
  </div>

  <%# モバイル用アクションボタン（ナビバー内に配置） %>
  <div class="navibar__actions"
       data-ui--navibar-target="footer"
       data-tab="plan"
       data-controller="plan--save-modal"
       data-plan--save-modal-plan-id-value="<%= plan.id %>"
       data-plan--save-modal-title-value="<%= plan.title %>">
    <button type="button"
            class="navibar__action-btn navibar__action-btn--share"
            data-controller="ui--share-modal"
            data-ui--share-modal-url-value="<%= plan_url(plan) %>"
            data-ui--share-modal-plan-id-value="<%= plan.id %>"
            data-action="click->ui--share-modal#open">
      <i class="bi bi-box-arrow-up"></i>
      共有
    </button>
    <button type="button"
            class="navibar__action-btn navibar__action-btn--save"
            data-action="click->plan--save-modal#open">
      <i class="bi bi-bookmark"></i>
      保存
    </button>
  </div>
</aside>
