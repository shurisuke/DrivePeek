<% content_for :body_class, "no-footer" %>

<div class="main-content plan-form"
     data-controller="ui--navibar-resize suggestion-tab--area-draw"
     data-ui--navibar-resize-min-value="300"
     data-ui--navibar-resize-max-percent-value="80"
     data-ui--navibar-resize-default-value="350">
  <!-- Âú∞Âõ≥ -->
  <div id="map" class="map" data-map-mode="edit" data-plan-id="<%= plan.id %>" data-ui--navibar-resize-target="map"></div>

  <!-- üîç Ê§úÁ¥¢„Éê„ÉºÔºàÂú∞Âõ≥‰∏äÈÉ®„Å´Èáç„Å≠„ÇãÁî®Ôºâ -->
  <div class="map-search-box">
    <input
      id="places-search-box"
      type="text"
      placeholder="Âú∞Âêç„ÇÑ„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢"
      class="form-control"
    >
  </div>

  <!-- Âú∞Âõ≥‰∏ä„ÅÆ„Éï„É≠„Éº„ÉÜ„Ç£„É≥„Ç∞„Éú„Çø„É≥Áæ§ -->
  <div class="map-floating-buttons">
    <!-- „Ç≥„Éü„É•„Éã„ÉÜ„Ç£„Éó„É©„É≥„Éó„É¨„Éì„É•„ÉºÈñâ„Åò„Çã„Éú„Çø„É≥ -->
    <button type="button"
            id="community-preview-close"
            class="map-floating-btn map-floating-btn--blue"
            hidden
            title="„Éó„É¨„Éì„É•„Éº„ÇíÈñâ„Åò„Çã"
            data-controller="community-tab--plan-preview"
            data-action="click->community-tab--plan-preview#hide">
      <i class="bi bi-x-lg" aria-hidden="true"></i>
      <i class="bi bi-share" aria-hidden="true"></i>
    </button>

    <!-- Ê§úÁ¥¢ÁµêÊûú„ÇØ„É™„Ç¢„Éú„Çø„É≥ -->
    <button type="button"
            id="search-hit-clear"
            class="map-floating-btn map-floating-btn--red"
            hidden
            title="Ê§úÁ¥¢ÁµêÊûú„Çí„ÇØ„É™„Ç¢"
            data-controller="ui--search-hit-clear"
            data-action="click->ui--search-hit-clear#clear">
      <i class="bi bi-x-lg" aria-hidden="true"></i>
      <i class="bi bi-search" aria-hidden="true"></i>
    </button>

    <!-- ÊèêÊ°à„Éî„É≥„ÇØ„É™„Ç¢„Éú„Çø„É≥ -->
    <button type="button"
            id="suggestion-pin-clear"
            class="map-floating-btn map-floating-btn--purple"
            hidden
            title="ÊèêÊ°à„Éî„É≥„Çí„ÇØ„É™„Ç¢"
            data-controller="suggestion-tab--pin-clear"
            data-action="click->suggestion-tab--pin-clear#clear">
      <i class="bi bi-x-lg" aria-hidden="true"></i>
      <i class="bi bi-stars" aria-hidden="true"></i>
    </button>
  </div>

  <!-- Â∑¶„Éä„Éì„Éê„ÉºÔºàTurbo FrameÂåñÔºâ -->
  <%= turbo_frame_tag "navibar" do %>
    <%= render "plans/navibar", plan: plan %>
  <% end %>

  <!-- „Éä„Éì„Éê„Éº„É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´ -->
  <div class="navibar-resize-handle"
       data-ui--navibar-resize-target="handle"
       data-action="mousedown->ui--navibar-resize#startResize touchstart->ui--navibar-resize#startResize click->ui--navibar-resize#handleClick">
    <div class="navibar-resize-handle__grip"></div>
  </div>

  <%# ÊèêÊ°à„Ç®„É™„Ç¢ÊèèÁîª„É¢„Éº„ÉÄ„É´ %>
  <%= render "suggestions/area_draw_modal" %>

  <%# ÊèêÊ°àÊù°‰ª∂Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´ %>
  <%= render "suggestions/condition_modal", plan: plan %>

  <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥Ôºà‰øùÂ≠ò„ÉªÂÖ±ÊúâÔºâ -->
  <div class="plan-actions"
       data-controller="ui--save-modal"
       data-ui--save-modal-plan-id-value="<%= plan.id %>"
       data-ui--save-modal-title-value="<%= plan.title %>">
    <div class="plan-actions__buttons">
      <button type="button"
              class="btn btn-action btn-action--share"
              data-controller="ui--share-modal"
              data-ui--share-modal-url-value="<%= plan_url(plan) %>"
              data-ui--share-modal-plan-id-value="<%= plan.id %>"
              data-action="click->ui--share-modal#open">
        ÂÖ±Êúâ
      </button>
      <button type="button"
              class="btn btn-action btn-action--save"
              data-action="click->ui--save-modal#open">
        ‰øùÂ≠ò
      </button>
    </div>
  </div>

</div>

<%# InfoWindow„Çπ„Ç±„É´„Éà„É≥„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºàJS„Åã„ÇâÂèÇÁÖßÔºâ %>
<%= render "map/infowindow_skeleton" %>

<%# „É¢„Éê„Ç§„É´Áî®InfoWindow„Éú„Éà„É†„Ç∑„Éº„Éà %>
<div id="mobile-infowindow"
     class="mobile-infowindow"
     data-controller="infowindow--mobile"
     hidden>
  <div class="mobile-infowindow__sheet" data-infowindow--mobile-target="sheet">
    <div class="mobile-infowindow__handle" data-infowindow--mobile-target="handle">
      <div class="mobile-infowindow__handle-bar"></div>
    </div>
    <div class="mobile-infowindow__content" id="mobile-infowindow-content">
      <%# InfoWindow „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„Åì„Åì„Å´ÊåøÂÖ•„Åï„Çå„ÇãÔºàÈñâ„Åò„Çã„Éú„Çø„É≥Âê´„ÇÄÔºâ %>
    </div>
  </div>
</div>
