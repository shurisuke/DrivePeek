<% content_for :body_class, "no-footer" %>

<div class="main-content plan-form"
     data-controller="navibar-resize ai-area-draw"
     data-navibar-resize-min-value="300"
     data-navibar-resize-max-percent-value="80"
     data-navibar-resize-default-value="350">
  <!-- Âú∞Âõ≥ -->
  <div id="map" class="map" data-map-mode="edit" data-plan-id="<%= plan.id %>" data-navibar-resize-target="map"></div>

  <!-- üîç Ê§úÁ¥¢„Éê„ÉºÔºàÂú∞Âõ≥‰∏äÈÉ®„Å´Èáç„Å≠„ÇãÁî®Ôºâ -->
  <div class="map-search-box">
    <input
      id="places-search-box"
      type="text"
      placeholder="Âú∞Âêç„ÇÑ„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢"
      class="form-control"
    >
  </div>

  <!-- Âú∞Âõ≥‰∏ä„ÅÆ„Éï„É≠„Éº„ÉÜ„Ç£„É≥„Ç∞„Éú„Çø„É≥Áæ§ -->
  <div class="map-floating-buttons">
    <!-- „Ç≥„Éü„É•„Éã„ÉÜ„Ç£„Éó„É©„É≥„Éó„É¨„Éì„É•„ÉºÈñâ„Åò„Çã„Éú„Çø„É≥ -->
    <button type="button"
            id="community-preview-close"
            class="map-floating-btn map-floating-btn--blue"
            hidden
            title="„Éó„É¨„Éì„É•„Éº„ÇíÈñâ„Åò„Çã"
            data-controller="community-plan-preview"
            data-action="click->community-plan-preview#hide">
      <i class="bi bi-x-lg" aria-hidden="true"></i>
      <i class="bi bi-share" aria-hidden="true"></i>
    </button>

    <!-- Ê§úÁ¥¢ÁµêÊûú„ÇØ„É™„Ç¢„Éú„Çø„É≥ -->
    <button type="button"
            id="search-hit-clear"
            class="map-floating-btn map-floating-btn--red"
            hidden
            title="Ê§úÁ¥¢ÁµêÊûú„Çí„ÇØ„É™„Ç¢"
            data-controller="search-hit-clear"
            data-action="click->search-hit-clear#clear">
      <i class="bi bi-x-lg" aria-hidden="true"></i>
      <i class="bi bi-search" aria-hidden="true"></i>
    </button>

    <!-- AIÊèêÊ°à„Éî„É≥„ÇØ„É™„Ç¢„Éú„Çø„É≥ -->
    <button type="button"
            id="ai-pin-clear"
            class="map-floating-btn map-floating-btn--purple"
            hidden
            title="AIÊèêÊ°à„Éî„É≥„Çí„ÇØ„É™„Ç¢"
            data-controller="ai-pin-clear"
            data-action="click->ai-pin-clear#clear">
      <i class="bi bi-x-lg" aria-hidden="true"></i>
      <i class="bi bi-stars" aria-hidden="true"></i>
    </button>
  </div>

  <!-- Â∑¶„Éä„Éì„Éê„ÉºÔºàTurbo FrameÂåñÔºâ -->
  <%= turbo_frame_tag "navibar" do %>
    <%= render "plans/navibar", plan: plan %>
  <% end %>

  <!-- „É™„Çµ„Ç§„Ç∫„Éè„É≥„Éâ„É´ -->
  <div class="navibar-resize-handle"
       data-navibar-resize-target="handle"
       data-action="mousedown->navibar-resize#startResize touchstart->navibar-resize#startResize click->navibar-resize#handleClick">
    <div class="navibar-resize-handle__grip"></div>
  </div>

  <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥Ôºà‰øùÂ≠ò„ÉªÂÖ±ÊúâÔºâ -->
  <div class="plan-actions"
       data-controller="plan-save-modal"
       data-plan-save-modal-plan-id-value="<%= plan.id %>"
       data-plan-save-modal-title-value="<%= plan.title %>">
    <div class="plan-actions__buttons">
      <button type="button"
              class="btn btn-action btn-action--share"
              data-controller="share-modal"
              data-share-modal-url-value="<%= plan_url(plan) %>"
              data-share-modal-plan-id-value="<%= plan.id %>"
              data-action="click->share-modal#open">
        ÂÖ±Êúâ
      </button>
      <button type="button"
              class="btn btn-action btn-action--save"
              data-action="click->plan-save-modal#open">
        ‰øùÂ≠ò
      </button>
    </div>
  </div>

</div>

<%# InfoWindow„Çπ„Ç±„É´„Éà„É≥„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºàJS„Åã„ÇâÂèÇÁÖßÔºâ %>
<%= render "map/infowindow_skeleton" %>

<%# „É¢„Éê„Ç§„É´Áî®InfoWindow„Éú„Éà„É†„Ç∑„Éº„Éà %>
<div id="mobile-infowindow"
     class="mobile-infowindow"
     data-controller="mobile-infowindow"
     hidden>
  <div class="mobile-infowindow__backdrop" data-action="click->mobile-infowindow#close"></div>
  <div class="mobile-infowindow__sheet" data-mobile-infowindow-target="sheet">
    <div class="mobile-infowindow__handle" data-mobile-infowindow-target="handle">
      <div class="mobile-infowindow__handle-bar"></div>
    </div>
    <button type="button"
            class="mobile-infowindow__close-btn"
            data-action="click->mobile-infowindow#close">
      <i class="bi bi-x-lg"></i>
    </button>
    <div class="mobile-infowindow__content" id="mobile-infowindow-content">
      <%# InfoWindow „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Åå„Åì„Åì„Å´ÊåøÂÖ•„Åï„Çå„Çã %>
    </div>
    <div class="mobile-infowindow__footer" id="mobile-infowindow-footer" hidden>
      <%# „Ç≥„É°„É≥„Éà„Éï„ÉÉ„Çø„Éº„ÅåJS„ÅßÁßªÂãï„Åï„Çå„Çã %>
    </div>
  </div>
</div>
