<div class="auth-page">
  <div class="auth-card">

    <% if params[:method] == "email" %>
      <div class="auth-header">
        <%= link_to new_user_session_path, class: "auth-back-link" do %>
          <i class="bi bi-arrow-left"></i>
        <% end %>
        <h2 class="auth-title">ログイン</h2>
      </div>
    <% else %>
      <h2 class="auth-title">ログイン</h2>
    <% end %>

    <% if params[:method] == "email" || resource.errors.any? %>
      <%= simple_form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
        <% if resource.errors.any? %>
          <ul class="auth-errors">
            <% resource.errors.full_messages.uniq.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        <% end %>

        <div class="form-group mb-3">
          <%= f.input :email,
                      label: 'メールアドレス',
                      required: true,
                      error: false,
                      input_html: { class: "form-control", autocomplete: "email" } %>
        </div>

        <div class="form-group mb-4">
          <%= f.input :password,
                      label: 'パスワード',
                      required: true,
                      error: false,
                      input_html: { class: "form-control", autocomplete: "current-password" } %>
        </div>

        <%= f.button :submit, "ログイン", class: "auth-submit" %>
      <% end %>

      <div class="auth-divider">または</div>

      <div class="auth-links">
        <%= link_to "アカウントを作成", new_user_registration_path %>
        <%= link_to "パスワードをお忘れですか？", new_user_password_path %>
      </div>

    <% else %>
      <p class="auth-description">ログイン方法を選択してください</p>

      <div class="auth-buttons">
        <%= link_to new_user_session_path(method: :email), class: "auth-btn auth-btn--email" do %>
          <i class="bi bi-envelope"></i>メールアドレスでログイン
        <% end %>

        <%= button_to user_line_omniauth_authorize_path, method: :post,
                      class: "auth-btn auth-btn--line",
                      data: { turbo: false } do %>
          <i class="bi bi-line"></i>LINEでログイン
        <% end %>

        <%= button_to user_twitter2_omniauth_authorize_path, method: :post,
                      class: "auth-btn auth-btn--x",
                      data: { turbo: false } do %>
          <i class="bi bi-twitter-x"></i>Xでログイン
        <% end %>
      </div>

      <div class="auth-divider">または</div>

      <div class="auth-links">
        <%= link_to "アカウントを作成", new_user_registration_path %>
      </div>
    <% end %>
  </div>
</div>
