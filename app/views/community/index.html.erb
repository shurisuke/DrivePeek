<%# みんなの旅 一覧ページ %>

<div class="list-page list-page--two-column">
  <h1 class="list-page__title">みんなの旅</h1>

  <%= turbo_frame_tag "community_content", data: { controller: "community-tab--scroll" } do %>
    <div class="list-page__content">
      <%# 左サイドバー: 検索フォーム %>
      <div class="list-page__sidebar">
        <%= render "shared/search_form",
                   form_url: community_path,
                   turbo_frame: "community_content",
                   search_type: @search_type,
                   selected_cities: @selected_cities,
                   cities_by_prefecture: @cities_by_prefecture,
                   genres_by_category: @genres_by_category,
                   selected_genre_ids: @selected_genre_ids,
                   search_query: @search_query,
                   circle: @circle %>

        <%= render "shared/results_bar",
                   count: @search_type == "spot" ? @spots_count : @plans_count,
                   count_label: @search_type == "spot" ? "スポット" : "プラン",
                   sort: @sort,
                   sort_options: [["newest", "新しい順"], ["oldest", "古い順"], ["popular", "人気順"]] %>
      </div>

      <%# 右メイン: カード一覧 + ページネーション %>
      <div class="list-page__main">
        <% if @search_type == "plan" %>
          <%= render "shared/plan_card_list",
                     plans: @community_plans,
                     empty_message: "まだ公開プランがありません",
                     empty_search_message: "条件に一致するプランが見つかりませんでした" %>
        <% else %>
          <%= render "shared/spot_card_list",
                     spots: @community_spots,
                     empty_message: "まだスポットがありません",
                     empty_search_message: "条件に一致するスポットが見つかりませんでした" %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
